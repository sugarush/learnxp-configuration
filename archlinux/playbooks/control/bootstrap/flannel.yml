---

  - hosts: tag_Cluster_{{ lookup('env', 'DEPLOY') }}_control

    vars:

      config: >
        {
          "Network": "192.168.0.0/16",
          "Backend": {
            "Type": "vxlan"
          }
        }

    tasks:

      - name: set flannel config
        uri:
          url: http://etcd.service.consul:2379/v2/keys/flannel/network/config
          method: PUT
          body: "value={{ config }}"
          status_code: 200,201
        run_once: yes
