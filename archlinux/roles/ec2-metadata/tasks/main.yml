---

  - name: get ec2 metadata
    ec2_metadata_facts:

  - name: set instance name tag
    ec2_tag:
      region: "{{ lookup('env', 'REGION') }}"
      resource: "{{ ansible_ec2_instance_id }}"
      tags:
        Name: "{{ lookup('env', 'HOSTNAME') }}"

  - name: set cluster tag
    ec2_tag:
      region: "{{ lookup('env', 'REGION') }}"
      resource: "{{ ansible_ec2_instance_id }}"
      tags:
        Cluster: "{{ lookup('env', 'ENVIRONMENT')}}-{{ lookup('env', 'ROLE') }}"
